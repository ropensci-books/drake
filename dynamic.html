<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Dynamic branching | The drake R Package User Manual</title>
  <meta name="description" content="In-depth walkthroughs and examples of drake, an R package for reproducible computation at scale." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Dynamic branching | The drake R Package User Manual" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://books.ropensci.org/drake/" />
  <meta property="og:image" content="https://books.ropensci.org/drake//images/logo.png" />
  <meta property="og:description" content="In-depth walkthroughs and examples of drake, an R package for reproducible computation at scale." />
  <meta name="github-repo" content="ropensci-books/drake" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Dynamic branching | The drake R Package User Manual" />
  
  <meta name="twitter:description" content="In-depth walkthroughs and examples of drake, an R package for reproducible computation at scale." />
  <meta name="twitter:image" content="https://books.ropensci.org/drake//images/logo.png" />

<meta name="author" content="Will Landau, Kirill Müller, Alex Axthelm, Jasper Clarkberg, Lorenz Walthert, Ellis Hughes, Matthew Mark Strasiotto" />
<meta name="author" content="Copyright Eli Lilly and Company" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="images/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="static.html"/>
<link rel="next" href="projects.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150843595-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150843595-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="https://ropensci.github.io/dev_guide/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The drake R Package User Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-drake-r-package"><i class="fa fa-check"></i><b>1.1</b> The drake R package</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-drake"><i class="fa fa-check"></i><b>1.3</b> Why drake?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#what-gets-done-stays-done."><i class="fa fa-check"></i><b>1.3.1</b> What gets done stays done.</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#reproducibility-with-confidence"><i class="fa fa-check"></i><b>1.3.2</b> Reproducibility with confidence</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#scale-up-and-out."><i class="fa fa-check"></i><b>1.3.3</b> Scale up and out.</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#with-docker"><i class="fa fa-check"></i><b>1.4</b> With Docker</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#documentation"><i class="fa fa-check"></i><b>1.5</b> Documentation</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#core-concepts"><i class="fa fa-check"></i><b>1.5.1</b> Core concepts</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#in-practice"><i class="fa fa-check"></i><b>1.5.2</b> In practice</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#use-cases"><i class="fa fa-check"></i><b>1.5.3</b> Use cases</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#drake-projects-as-r-packages"><i class="fa fa-check"></i><b>1.5.4</b> <code>drake</code> projects as R packages</a></li>
<li class="chapter" data-level="1.5.5" data-path="index.html"><a href="index.html#frequently-asked-questions"><i class="fa fa-check"></i><b>1.5.5</b> Frequently asked questions</a></li>
<li class="chapter" data-level="1.5.6" data-path="index.html"><a href="index.html#reference"><i class="fa fa-check"></i><b>1.5.6</b> Reference</a></li>
<li class="chapter" data-level="1.5.7" data-path="index.html"><a href="index.html#function-reference"><i class="fa fa-check"></i><b>1.5.7</b> Function reference</a></li>
<li class="chapter" data-level="1.5.8" data-path="index.html"><a href="index.html#tutorials"><i class="fa fa-check"></i><b>1.5.8</b> Tutorials</a></li>
<li class="chapter" data-level="1.5.9" data-path="index.html"><a href="index.html#examples"><i class="fa fa-check"></i><b>1.5.9</b> Examples</a></li>
<li class="chapter" data-level="1.5.10" data-path="index.html"><a href="index.html#presentations"><i class="fa fa-check"></i><b>1.5.10</b> Presentations</a></li>
<li class="chapter" data-level="1.5.11" data-path="index.html"><a href="index.html#context-and-history"><i class="fa fa-check"></i><b>1.5.11</b> Context and history</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#help-and-troubleshooting"><i class="fa fa-check"></i><b>1.6</b> Help and troubleshooting</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="similar-work.html"><a href="similar-work.html"><i class="fa fa-check"></i><b>2</b> Similar work</a>
<ul>
<li class="chapter" data-level="2.1" data-path="similar-work.html"><a href="similar-work.html#pipeline-tools"><i class="fa fa-check"></i><b>2.1</b> Pipeline tools</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="similar-work.html"><a href="similar-work.html#gnu-make"><i class="fa fa-check"></i><b>2.1.1</b> GNU Make</a></li>
<li class="chapter" data-level="2.1.2" data-path="similar-work.html"><a href="similar-work.html#remake"><i class="fa fa-check"></i><b>2.1.2</b> Remake</a></li>
<li class="chapter" data-level="2.1.3" data-path="similar-work.html"><a href="similar-work.html#factuals-drake"><i class="fa fa-check"></i><b>2.1.3</b> Factual’s Drake</a></li>
<li class="chapter" data-level="2.1.4" data-path="similar-work.html"><a href="similar-work.html#other-pipeline-tools"><i class="fa fa-check"></i><b>2.1.4</b> Other pipeline tools</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="similar-work.html"><a href="similar-work.html#memoization"><i class="fa fa-check"></i><b>2.2</b> Memoization</a></li>
<li class="chapter" data-level="2.3" data-path="similar-work.html"><a href="similar-work.html#literate-programming"><i class="fa fa-check"></i><b>2.3</b> Literate programming</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="similar-work.html"><a href="similar-work.html#knitr-and-r-markdown"><i class="fa fa-check"></i><b>2.3.1</b> knitr and R Markdown</a></li>
<li class="chapter" data-level="2.3.2" data-path="similar-work.html"><a href="similar-work.html#version-control"><i class="fa fa-check"></i><b>2.3.2</b> Version control</a></li>
<li class="chapter" data-level="2.3.3" data-path="similar-work.html"><a href="similar-work.html#containerization-and-r-package-environments"><i class="fa fa-check"></i><b>2.3.3</b> Containerization and R package environments</a></li>
<li class="chapter" data-level="2.3.4" data-path="similar-work.html"><a href="similar-work.html#workflowr"><i class="fa fa-check"></i><b>2.3.4</b> workflowr</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="similar-work.html"><a href="similar-work.html#acknowledgements"><i class="fa fa-check"></i><b>2.4</b> Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Getting started</b></span></li>
<li class="chapter" data-level="3" data-path="walkthrough.html"><a href="walkthrough.html"><i class="fa fa-check"></i><b>3</b> Walkthrough</a>
<ul>
<li class="chapter" data-level="3.1" data-path="walkthrough.html"><a href="walkthrough.html#set-the-stage."><i class="fa fa-check"></i><b>3.1</b> Set the stage.</a></li>
<li class="chapter" data-level="3.2" data-path="walkthrough.html"><a href="walkthrough.html#make-your-results."><i class="fa fa-check"></i><b>3.2</b> Make your results.</a></li>
<li class="chapter" data-level="3.3" data-path="walkthrough.html"><a href="walkthrough.html#go-back-and-fix-things."><i class="fa fa-check"></i><b>3.3</b> Go back and fix things.</a></li>
<li class="chapter" data-level="3.4" data-path="walkthrough.html"><a href="walkthrough.html#history-and-provenance"><i class="fa fa-check"></i><b>3.4</b> History and provenance</a></li>
<li class="chapter" data-level="3.5" data-path="walkthrough.html"><a href="walkthrough.html#reproducible-data-recovery-and-renaming"><i class="fa fa-check"></i><b>3.5</b> Reproducible data recovery and renaming</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="walkthrough.html"><a href="walkthrough.html#undoing-clean"><i class="fa fa-check"></i><b>3.5.1</b> Undoing <code>clean()</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="walkthrough.html"><a href="walkthrough.html#renaming"><i class="fa fa-check"></i><b>3.5.2</b> Renaming</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="walkthrough.html"><a href="walkthrough.html#try-the-code-yourself"><i class="fa fa-check"></i><b>3.6</b> Try the code yourself!</a></li>
<li class="chapter" data-level="3.7" data-path="walkthrough.html"><a href="walkthrough.html#thanks"><i class="fa fa-check"></i><b>3.7</b> Thanks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plans.html"><a href="plans.html"><i class="fa fa-check"></i><b>4</b> <code>drake</code> plans</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plans.html"><a href="plans.html#functions"><i class="fa fa-check"></i><b>4.1</b> Functions</a></li>
<li class="chapter" data-level="4.2" data-path="plans.html"><a href="plans.html#intro-to-plans"><i class="fa fa-check"></i><b>4.2</b> Intro to plans</a></li>
<li class="chapter" data-level="4.3" data-path="plans.html"><a href="plans.html#a-strategy-for-building-up-plans"><i class="fa fa-check"></i><b>4.3</b> A strategy for building up plans</a></li>
<li class="chapter" data-level="4.4" data-path="plans.html"><a href="plans.html#how-to-choose-good-targets"><i class="fa fa-check"></i><b>4.4</b> How to choose good targets</a></li>
<li class="chapter" data-level="4.5" data-path="plans.html"><a href="plans.html#special-data-formats-for-targets"><i class="fa fa-check"></i><b>4.5</b> Special data formats for targets</a></li>
<li class="chapter" data-level="4.6" data-path="plans.html"><a href="plans.html#special-columns"><i class="fa fa-check"></i><b>4.6</b> Special columns</a></li>
<li class="chapter" data-level="4.7" data-path="plans.html"><a href="plans.html#static-files"><i class="fa fa-check"></i><b>4.7</b> Static files</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="plans.html"><a href="plans.html#urls"><i class="fa fa-check"></i><b>4.7.1</b> URLs</a></li>
<li class="chapter" data-level="4.7.2" data-path="plans.html"><a href="plans.html#limitations-of-static-files"><i class="fa fa-check"></i><b>4.7.2</b> Limitations of static files</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="plans.html"><a href="plans.html#dynamic-files"><i class="fa fa-check"></i><b>4.8</b> Dynamic files</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="plans.html"><a href="plans.html#how-to-use-dynamic-files"><i class="fa fa-check"></i><b>4.8.1</b> How to use dynamic files</a></li>
<li class="chapter" data-level="4.8.2" data-path="plans.html"><a href="plans.html#example-of-dynamic-files"><i class="fa fa-check"></i><b>4.8.2</b> Example of dynamic files</a></li>
<li class="chapter" data-level="4.8.3" data-path="plans.html"><a href="plans.html#limitations-of-dynamic-files"><i class="fa fa-check"></i><b>4.8.3</b> Limitations of dynamic files</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="plans.html"><a href="plans.html#large-plans"><i class="fa fa-check"></i><b>4.9</b> Large plans</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="static.html"><a href="static.html"><i class="fa fa-check"></i><b>5</b> Static branching</a>
<ul>
<li class="chapter" data-level="5.1" data-path="static.html"><a href="static.html#why-static-branching"><i class="fa fa-check"></i><b>5.1</b> Why static branching?</a></li>
<li class="chapter" data-level="5.2" data-path="static.html"><a href="static.html#grouping-variables"><i class="fa fa-check"></i><b>5.2</b> Grouping variables</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="static.html"><a href="static.html#limitations-of-grouping-variables"><i class="fa fa-check"></i><b>5.2.1</b> Limitations of grouping variables</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="static.html"><a href="static.html#tidy-evaluation"><i class="fa fa-check"></i><b>5.3</b> Tidy evaluation</a></li>
<li class="chapter" data-level="5.4" data-path="static.html"><a href="static.html#static-transformations"><i class="fa fa-check"></i><b>5.4</b> Static transformations</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="static.html"><a href="static.html#map"><i class="fa fa-check"></i><b>5.4.1</b> <code>map()</code></a></li>
<li class="chapter" data-level="5.4.2" data-path="static.html"><a href="static.html#cross"><i class="fa fa-check"></i><b>5.4.2</b> <code>cross()</code></a></li>
<li class="chapter" data-level="5.4.3" data-path="static.html"><a href="static.html#split"><i class="fa fa-check"></i><b>5.4.3</b> <code>split()</code></a></li>
<li class="chapter" data-level="5.4.4" data-path="static.html"><a href="static.html#combine"><i class="fa fa-check"></i><b>5.4.4</b> <code>combine()</code></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="static.html"><a href="static.html#target-names"><i class="fa fa-check"></i><b>5.5</b> Target names</a></li>
<li class="chapter" data-level="5.6" data-path="static.html"><a href="static.html#tags"><i class="fa fa-check"></i><b>5.6</b> Tags</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dynamic.html"><a href="dynamic.html"><i class="fa fa-check"></i><b>6</b> Dynamic branching</a>
<ul>
<li class="chapter" data-level="6.1" data-path="dynamic.html"><a href="dynamic.html#a-note-about-versions"><i class="fa fa-check"></i><b>6.1</b> A note about versions</a></li>
<li class="chapter" data-level="6.2" data-path="dynamic.html"><a href="dynamic.html#motivation"><i class="fa fa-check"></i><b>6.2</b> Motivation</a></li>
<li class="chapter" data-level="6.3" data-path="dynamic.html"><a href="dynamic.html#which-kind-of-branching-should-i-use"><i class="fa fa-check"></i><b>6.3</b> Which kind of branching should I use?</a></li>
<li class="chapter" data-level="6.4" data-path="dynamic.html"><a href="dynamic.html#dynamic-targets"><i class="fa fa-check"></i><b>6.4</b> Dynamic targets</a></li>
<li class="chapter" data-level="6.5" data-path="dynamic.html"><a href="dynamic.html#dynamic-transformations"><i class="fa fa-check"></i><b>6.5</b> Dynamic transformations</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="static.html"><a href="static.html#map"><i class="fa fa-check"></i><b>6.5.1</b> <code>map()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="static.html"><a href="static.html#cross"><i class="fa fa-check"></i><b>6.5.2</b> <code>cross()</code></a></li>
<li class="chapter" data-level="6.5.3" data-path="dynamic.html"><a href="dynamic.html#group"><i class="fa fa-check"></i><b>6.5.3</b> <code>group()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="dynamic.html"><a href="dynamic.html#trace"><i class="fa fa-check"></i><b>6.6</b> Trace</a></li>
<li class="chapter" data-level="6.7" data-path="dynamic.html"><a href="dynamic.html#max_expand"><i class="fa fa-check"></i><b>6.7</b> <code>max_expand</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="projects.html"><a href="projects.html"><i class="fa fa-check"></i><b>7</b> <code>drake</code> projects</a>
<ul>
<li class="chapter" data-level="7.1" data-path="projects.html"><a href="projects.html#external-resources"><i class="fa fa-check"></i><b>7.1</b> External resources</a></li>
<li class="chapter" data-level="7.2" data-path="projects.html"><a href="projects.html#code-files"><i class="fa fa-check"></i><b>7.2</b> Code files</a></li>
<li class="chapter" data-level="7.3" data-path="projects.html"><a href="projects.html#safer-interactivity"><i class="fa fa-check"></i><b>7.3</b> Safer interactivity</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="dynamic.html"><a href="dynamic.html#motivation"><i class="fa fa-check"></i><b>7.3.1</b> Motivation</a></li>
<li class="chapter" data-level="7.3.2" data-path="projects.html"><a href="projects.html#usage"><i class="fa fa-check"></i><b>7.3.2</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="projects.html"><a href="projects.html#script-file-pitfalls"><i class="fa fa-check"></i><b>7.4</b> Script file pitfalls</a></li>
<li class="chapter" data-level="7.5" data-path="projects.html"><a href="projects.html#workflows-as-r-packages"><i class="fa fa-check"></i><b>7.5</b> Workflows as R packages</a></li>
<li class="chapter" data-level="7.6" data-path="projects.html"><a href="projects.html#other-tools"><i class="fa fa-check"></i><b>7.6</b> Other tools</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="scripts.html"><a href="scripts.html"><i class="fa fa-check"></i><b>8</b> Script-based workflows</a>
<ul>
<li class="chapter" data-level="8.1" data-path="scripts.html"><a href="scripts.html#function-oriented-workflows"><i class="fa fa-check"></i><b>8.1</b> Function-oriented workflows</a></li>
<li class="chapter" data-level="8.2" data-path="scripts.html"><a href="scripts.html#traditional-and-legacy-workflows"><i class="fa fa-check"></i><b>8.2</b> Traditional and legacy workflows</a></li>
<li class="chapter" data-level="8.3" data-path="scripts.html"><a href="scripts.html#overcoming-technical-debt"><i class="fa fa-check"></i><b>8.3</b> Overcoming Technical Debt</a></li>
<li class="chapter" data-level="8.4" data-path="scripts.html"><a href="scripts.html#dependencies"><i class="fa fa-check"></i><b>8.4</b> Dependencies</a></li>
<li class="chapter" data-level="8.5" data-path="scripts.html"><a href="scripts.html#building-the-connections"><i class="fa fa-check"></i><b>8.5</b> Building the connections</a></li>
<li class="chapter" data-level="8.6" data-path="scripts.html"><a href="scripts.html#run-the-workflow"><i class="fa fa-check"></i><b>8.6</b> Run the workflow</a></li>
<li class="chapter" data-level="8.7" data-path="scripts.html"><a href="scripts.html#keeping-the-results-up-to-date"><i class="fa fa-check"></i><b>8.7</b> Keeping the results up to date</a></li>
<li class="chapter" data-level="8.8" data-path="scripts.html"><a href="scripts.html#final-thoughts"><i class="fa fa-check"></i><b>8.8</b> Final thoughts</a></li>
</ul></li>
<li class="part"><span><b>II Examples</b></span></li>
<li class="chapter" data-level="9" data-path="churn.html"><a href="churn.html"><i class="fa fa-check"></i><b>9</b> Customer churn and deep learning</a>
<ul>
<li class="chapter" data-level="9.1" data-path="churn.html"><a href="churn.html#packages"><i class="fa fa-check"></i><b>9.1</b> Packages</a></li>
<li class="chapter" data-level="9.2" data-path="plans.html"><a href="plans.html#functions"><i class="fa fa-check"></i><b>9.2</b> Functions</a></li>
<li class="chapter" data-level="9.3" data-path="churn.html"><a href="churn.html#plan"><i class="fa fa-check"></i><b>9.3</b> Plan</a></li>
<li class="chapter" data-level="9.4" data-path="churn.html"><a href="churn.html#dependency-graph"><i class="fa fa-check"></i><b>9.4</b> Dependency graph</a></li>
<li class="chapter" data-level="9.5" data-path="churn.html"><a href="churn.html#run-the-models"><i class="fa fa-check"></i><b>9.5</b> Run the models</a></li>
<li class="chapter" data-level="9.6" data-path="churn.html"><a href="churn.html#inspect-the-results"><i class="fa fa-check"></i><b>9.6</b> Inspect the results</a></li>
<li class="chapter" data-level="9.7" data-path="churn.html"><a href="churn.html#add-models"><i class="fa fa-check"></i><b>9.7</b> Add models</a></li>
<li class="chapter" data-level="9.8" data-path="churn.html"><a href="churn.html#inspect-the-results-again"><i class="fa fa-check"></i><b>9.8</b> Inspect the results again</a></li>
<li class="chapter" data-level="9.9" data-path="churn.html"><a href="churn.html#update-your-code"><i class="fa fa-check"></i><b>9.9</b> Update your code</a></li>
<li class="chapter" data-level="9.10" data-path="walkthrough.html"><a href="walkthrough.html#history-and-provenance"><i class="fa fa-check"></i><b>9.10</b> History and provenance</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>10</b> Validating a small hierarchical model with Stan</a>
<ul>
<li class="chapter" data-level="10.1" data-path="stan.html"><a href="stan.html#the-drake-project"><i class="fa fa-check"></i><b>10.1</b> The <code>drake</code> project</a></li>
<li class="chapter" data-level="10.2" data-path="plans.html"><a href="plans.html#functions"><i class="fa fa-check"></i><b>10.2</b> Functions</a></li>
<li class="chapter" data-level="10.3" data-path="churn.html"><a href="churn.html#plan"><i class="fa fa-check"></i><b>10.3</b> Plan</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="stan.html"><a href="stan.html#model"><i class="fa fa-check"></i><b>10.3.1</b> Model</a></li>
<li class="chapter" data-level="10.3.2" data-path="stan.html"><a href="stan.html#index"><i class="fa fa-check"></i><b>10.3.2</b> Index</a></li>
<li class="chapter" data-level="10.3.3" data-path="stan.html"><a href="stan.html#data"><i class="fa fa-check"></i><b>10.3.3</b> Data</a></li>
<li class="chapter" data-level="10.3.4" data-path="stan.html"><a href="stan.html#fit"><i class="fa fa-check"></i><b>10.3.4</b> Fit</a></li>
<li class="chapter" data-level="10.3.5" data-path="stan.html"><a href="stan.html#report"><i class="fa fa-check"></i><b>10.3.5</b> Report</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="stan.html"><a href="stan.html#try-it-out"><i class="fa fa-check"></i><b>10.4</b> Try it out!</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="churn.html"><a href="churn.html#packages"><i class="fa fa-check"></i><b>11</b> An analysis of R package download trends</a>
<ul>
<li class="chapter" data-level="11.1" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>11.1</b> Get the code.</a></li>
<li class="chapter" data-level="11.2" data-path="packages.html"><a href="packages.html#overview"><i class="fa fa-check"></i><b>11.2</b> Overview</a></li>
<li class="chapter" data-level="11.3" data-path="packages.html"><a href="packages.html#analysis"><i class="fa fa-check"></i><b>11.3</b> Analysis</a></li>
<li class="chapter" data-level="11.4" data-path="packages.html"><a href="packages.html#other-ways-to-trigger-downloads"><i class="fa fa-check"></i><b>11.4</b> Other ways to trigger downloads</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="gsp.html"><a href="gsp.html"><i class="fa fa-check"></i><b>12</b> Finding the best model of gross state product</a>
<ul>
<li class="chapter" data-level="12.1" data-path="packages.html"><a href="packages.html#get-the-code."><i class="fa fa-check"></i><b>12.1</b> Get the code.</a></li>
<li class="chapter" data-level="12.2" data-path="gsp.html"><a href="gsp.html#objective-and-methods"><i class="fa fa-check"></i><b>12.2</b> Objective and methods</a></li>
<li class="chapter" data-level="12.3" data-path="stan.html"><a href="stan.html#data"><i class="fa fa-check"></i><b>12.3</b> Data</a></li>
<li class="chapter" data-level="12.4" data-path="packages.html"><a href="packages.html#analysis"><i class="fa fa-check"></i><b>12.4</b> Analysis</a></li>
<li class="chapter" data-level="12.5" data-path="gsp.html"><a href="gsp.html#results"><i class="fa fa-check"></i><b>12.5</b> Results</a></li>
<li class="chapter" data-level="12.6" data-path="gsp.html"><a href="gsp.html#comparison-with-gnu-make"><i class="fa fa-check"></i><b>12.6</b> Comparison with GNU Make</a></li>
<li class="chapter" data-level="12.7" data-path="gsp.html"><a href="gsp.html#references"><i class="fa fa-check"></i><b>12.7</b> References</a></li>
</ul></li>
<li class="part"><span><b>III Resource management</b></span></li>
<li class="chapter" data-level="13" data-path="hpc.html"><a href="hpc.html"><i class="fa fa-check"></i><b>13</b> High-performance computing</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hpc.html"><a href="hpc.html#start-small"><i class="fa fa-check"></i><b>13.1</b> Start small</a></li>
<li class="chapter" data-level="13.2" data-path="hpc.html"><a href="hpc.html#let-make-schedule-your-targets."><i class="fa fa-check"></i><b>13.2</b> Let <code>make()</code> schedule your targets.</a></li>
<li class="chapter" data-level="13.3" data-path="hpc.html"><a href="hpc.html#the-master-process"><i class="fa fa-check"></i><b>13.3</b> The master process</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="hpc.html"><a href="hpc.html#master-on-a-cluster"><i class="fa fa-check"></i><b>13.3.1</b> Master on a cluster</a></li>
<li class="chapter" data-level="13.3.2" data-path="hpc.html"><a href="hpc.html#local-master"><i class="fa fa-check"></i><b>13.3.2</b> Local master</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="hpc.html"><a href="hpc.html#parallel-backends"><i class="fa fa-check"></i><b>13.4</b> Parallel backends</a></li>
<li class="chapter" data-level="13.5" data-path="hpc.html"><a href="hpc.html#the-clustermq-backend"><i class="fa fa-check"></i><b>13.5</b> The <code>clustermq</code> backend</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="hpc.html"><a href="hpc.html#persistent-workers"><i class="fa fa-check"></i><b>13.5.1</b> Persistent workers</a></li>
<li class="chapter" data-level="13.5.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>13.5.2</b> Installation</a></li>
<li class="chapter" data-level="13.5.3" data-path="hpc.html"><a href="hpc.html#on-your-local-machine"><i class="fa fa-check"></i><b>13.5.3</b> On your local machine</a></li>
<li class="chapter" data-level="13.5.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster"><i class="fa fa-check"></i><b>13.5.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="hpc.html"><a href="hpc.html#the-future-backend"><i class="fa fa-check"></i><b>13.6</b> The <code>future</code> backend</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="hpc.html"><a href="hpc.html#transient-workers"><i class="fa fa-check"></i><b>13.6.1</b> Transient workers</a></li>
<li class="chapter" data-level="13.6.2" data-path="hpc.html"><a href="hpc.html#installation-1"><i class="fa fa-check"></i><b>13.6.2</b> Installation</a></li>
<li class="chapter" data-level="13.6.3" data-path="hpc.html"><a href="hpc.html#on-your-local-machine-1"><i class="fa fa-check"></i><b>13.6.3</b> On your local machine</a></li>
<li class="chapter" data-level="13.6.4" data-path="hpc.html"><a href="hpc.html#on-a-cluster-1"><i class="fa fa-check"></i><b>13.6.4</b> On a cluster</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="hpc.html"><a href="hpc.html#advanced-options"><i class="fa fa-check"></i><b>13.7</b> Advanced options</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="hpc.html"><a href="hpc.html#selectivity"><i class="fa fa-check"></i><b>13.7.1</b> Selectivity</a></li>
<li class="chapter" data-level="13.7.2" data-path="hpc.html"><a href="hpc.html#memory-options"><i class="fa fa-check"></i><b>13.7.2</b> Memory options</a></li>
<li class="chapter" data-level="13.7.3" data-path="hpc.html"><a href="hpc.html#storage-options"><i class="fa fa-check"></i><b>13.7.3</b> Storage options</a></li>
<li class="chapter" data-level="13.7.4" data-path="hpc.html"><a href="hpc.html#the-template-argument-for-persistent-workers"><i class="fa fa-check"></i><b>13.7.4</b> The <code>template</code> argument for persistent workers</a></li>
<li class="chapter" data-level="13.7.5" data-path="hpc.html"><a href="hpc.html#the-resources-column-for-transient-workers"><i class="fa fa-check"></i><b>13.7.5</b> The <code>resources</code> column for transient workers</a></li>
<li class="chapter" data-level="13.7.6" data-path="hpc.html"><a href="hpc.html#parallel-computing-within-targets"><i class="fa fa-check"></i><b>13.7.6</b> Parallel computing <em>within</em> targets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="time.html"><a href="time.html"><i class="fa fa-check"></i><b>14</b> Time: speed, time logging, prediction, and strategy</a>
<ul>
<li class="chapter" data-level="14.1" data-path="time.html"><a href="time.html#why-is-drake-so-slow"><i class="fa fa-check"></i><b>14.1</b> Why is <code>drake</code> so slow?</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="time.html"><a href="time.html#help-us-find-out"><i class="fa fa-check"></i><b>14.1.1</b> Help us find out!</a></li>
<li class="chapter" data-level="14.1.2" data-path="time.html"><a href="time.html#too-many-targets"><i class="fa fa-check"></i><b>14.1.2</b> Too many targets?</a></li>
<li class="chapter" data-level="14.1.3" data-path="time.html"><a href="time.html#big-data"><i class="fa fa-check"></i><b>14.1.3</b> Big data?</a></li>
<li class="chapter" data-level="14.1.4" data-path="time.html"><a href="time.html#aggressive-shortcuts"><i class="fa fa-check"></i><b>14.1.4</b> Aggressive shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="time.html"><a href="time.html#time-logging"><i class="fa fa-check"></i><b>14.2</b> Time logging</a></li>
<li class="chapter" data-level="14.3" data-path="time.html"><a href="time.html#predict-total-runtime"><i class="fa fa-check"></i><b>14.3</b> Predict total runtime</a></li>
<li class="chapter" data-level="14.4" data-path="time.html"><a href="time.html#strategize-your-high-performance-computing"><i class="fa fa-check"></i><b>14.4</b> Strategize your high-performance computing</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="memory.html"><a href="memory.html"><i class="fa fa-check"></i><b>15</b> Memory management</a>
<ul>
<li class="chapter" data-level="15.1" data-path="memory.html"><a href="memory.html#garbage-collection-and-custom-files"><i class="fa fa-check"></i><b>15.1</b> Garbage collection and custom files</a></li>
<li class="chapter" data-level="15.2" data-path="memory.html"><a href="memory.html#memory-strategies"><i class="fa fa-check"></i><b>15.2</b> Memory strategies</a></li>
<li class="chapter" data-level="15.3" data-path="memory.html"><a href="memory.html#data-splitting"><i class="fa fa-check"></i><b>15.3</b> Data splitting</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="storage.html"><a href="storage.html"><i class="fa fa-check"></i><b>16</b> Storage</a>
<ul>
<li class="chapter" data-level="16.1" data-path="storage.html"><a href="storage.html#drakes-cache"><i class="fa fa-check"></i><b>16.1</b> <code>drake</code>’s cache</a></li>
<li class="chapter" data-level="16.2" data-path="storage.html"><a href="storage.html#efficient-target-storage"><i class="fa fa-check"></i><b>16.2</b> Efficient target storage</a></li>
<li class="chapter" data-level="16.3" data-path="storage.html"><a href="storage.html#why-is-my-cache-so-big"><i class="fa fa-check"></i><b>16.3</b> Why is my cache so big?</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="storage.html"><a href="storage.html#old-targets"><i class="fa fa-check"></i><b>16.3.1</b> Old targets</a></li>
<li class="chapter" data-level="16.3.2" data-path="storage.html"><a href="storage.html#garbage-from-interrupted-builds"><i class="fa fa-check"></i><b>16.3.2</b> Garbage from interrupted builds</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="storage.html"><a href="storage.html#interfaces-to-the-cache"><i class="fa fa-check"></i><b>16.4</b> Interfaces to the cache</a></li>
</ul></li>
<li class="part"><span><b>IV Extra features</b></span></li>
<li class="chapter" data-level="17" data-path="visuals.html"><a href="visuals.html"><i class="fa fa-check"></i><b>17</b> Visualization with drake</a>
<ul>
<li class="chapter" data-level="17.1" data-path="visuals.html"><a href="visuals.html#plotting-plans"><i class="fa fa-check"></i><b>17.1</b> Plotting plans</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="visuals.html"><a href="visuals.html#vis_drake_graph"><i class="fa fa-check"></i><b>17.1.1</b> <code>vis_drake_graph()</code></a></li>
<li class="chapter" data-level="17.1.2" data-path="visuals.html"><a href="visuals.html#sankey_drake_graph"><i class="fa fa-check"></i><b>17.1.2</b> <code>sankey_drake_graph()</code></a></li>
<li class="chapter" data-level="17.1.3" data-path="visuals.html"><a href="visuals.html#drake_ggraph"><i class="fa fa-check"></i><b>17.1.3</b> <code>drake_ggraph()</code></a></li>
<li class="chapter" data-level="17.1.4" data-path="visuals.html"><a href="visuals.html#text_drake_graph"><i class="fa fa-check"></i><b>17.1.4</b> <code>text_drake_graph()</code></a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="visuals.html"><a href="visuals.html#underlying-graph-data-node-and-edge-data-frames"><i class="fa fa-check"></i><b>17.2</b> Underlying graph data: node and edge data frames</a></li>
<li class="chapter" data-level="17.3" data-path="visuals.html"><a href="visuals.html#visualizing-target-status"><i class="fa fa-check"></i><b>17.3</b> Visualizing target status</a></li>
<li class="chapter" data-level="17.4" data-path="visuals.html"><a href="visuals.html#subgraphs"><i class="fa fa-check"></i><b>17.4</b> Subgraphs</a></li>
<li class="chapter" data-level="17.5" data-path="visuals.html"><a href="visuals.html#control-the-vis_drake_graph-legend."><i class="fa fa-check"></i><b>17.5</b> Control the <code>vis_drake_graph()</code> legend.</a></li>
<li class="chapter" data-level="17.6" data-path="visuals.html"><a href="visuals.html#clusters"><i class="fa fa-check"></i><b>17.6</b> Clusters</a></li>
<li class="chapter" data-level="17.7" data-path="visuals.html"><a href="visuals.html#output-files"><i class="fa fa-check"></i><b>17.7</b> Output files</a></li>
<li class="chapter" data-level="17.8" data-path="visuals.html"><a href="visuals.html#node-selection"><i class="fa fa-check"></i><b>17.8</b> Node Selection</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="visuals.html"><a href="visuals.html#perform-the-default-action-on-select"><i class="fa fa-check"></i><b>17.8.1</b> Perform the default action on select</a></li>
<li class="chapter" data-level="17.8.2" data-path="visuals.html"><a href="visuals.html#perform-no-action-on-select"><i class="fa fa-check"></i><b>17.8.2</b> Perform no action on select</a></li>
<li class="chapter" data-level="17.8.3" data-path="visuals.html"><a href="visuals.html#customize-the-onselect-event-behaviour"><i class="fa fa-check"></i><b>17.8.3</b> Customize the onSelect event behaviour</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>18</b> Debugging and testing drake projects</a>
<ul>
<li class="chapter" data-level="18.1" data-path="debugging.html"><a href="debugging.html#debugging-failed-targets"><i class="fa fa-check"></i><b>18.1</b> Debugging failed targets</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="debugging.html"><a href="debugging.html#diagnosing-errors"><i class="fa fa-check"></i><b>18.1.1</b> Diagnosing errors</a></li>
<li class="chapter" data-level="18.1.2" data-path="debugging.html"><a href="debugging.html#interactive-debugging"><i class="fa fa-check"></i><b>18.1.2</b> Interactive debugging</a></li>
<li class="chapter" data-level="18.1.3" data-path="debugging.html"><a href="debugging.html#efficient-trial-and-error"><i class="fa fa-check"></i><b>18.1.3</b> Efficient trial and error</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="debugging.html"><a href="debugging.html#why-do-my-targets-keep-rerunning"><i class="fa fa-check"></i><b>18.2</b> Why do my targets keep rerunning?</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="debugging.html"><a href="debugging.html#how-your-workflow-fits-together"><i class="fa fa-check"></i><b>18.2.1</b> How your workflow fits together</a></li>
<li class="chapter" data-level="18.2.2" data-path="debugging.html"><a href="debugging.html#which-targets-are-outdated"><i class="fa fa-check"></i><b>18.2.2</b> Which targets are outdated</a></li>
<li class="chapter" data-level="18.2.3" data-path="debugging.html"><a href="debugging.html#why-your-targets-are-outdated"><i class="fa fa-check"></i><b>18.2.3</b> Why your targets are outdated</a></li>
<li class="chapter" data-level="18.2.4" data-path="debugging.html"><a href="debugging.html#strategies-to-prevent-unexpected-changes-in-the-future"><i class="fa fa-check"></i><b>18.2.4</b> Strategies to prevent unexpected changes in the future</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="debugging.html"><a href="debugging.html#more-help"><i class="fa fa-check"></i><b>18.3</b> More help</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="triggers.html"><a href="triggers.html"><i class="fa fa-check"></i><b>19</b> Triggers: decision rules for building targets</a>
<ul>
<li class="chapter" data-level="19.1" data-path="triggers.html"><a href="triggers.html#what-are-triggers"><i class="fa fa-check"></i><b>19.1</b> What are triggers?</a></li>
<li class="chapter" data-level="19.2" data-path="triggers.html"><a href="triggers.html#customization"><i class="fa fa-check"></i><b>19.2</b> Customization</a></li>
<li class="chapter" data-level="19.3" data-path="triggers.html"><a href="triggers.html#alternative-trigger-modes"><i class="fa fa-check"></i><b>19.3</b> Alternative trigger modes</a></li>
<li class="chapter" data-level="19.4" data-path="triggers.html"><a href="triggers.html#a-more-practical-example"><i class="fa fa-check"></i><b>19.4</b> A more practical example</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="faq.html"><a href="faq.html"><i class="fa fa-check"></i><b>A</b> Frequently-asked questions</a></li>
<li class="chapter" data-level="B" data-path="design.html"><a href="design.html"><i class="fa fa-check"></i><b>B</b> Design</a>
<ul>
<li class="chapter" data-level="B.1" data-path="design.html"><a href="design.html#principles"><i class="fa fa-check"></i><b>B.1</b> Principles</a>
<ul>
<li class="chapter" data-level="B.1.1" data-path="design.html"><a href="design.html#functions-first"><i class="fa fa-check"></i><b>B.1.1</b> Functions first</a></li>
<li class="chapter" data-level="B.1.2" data-path="design.html"><a href="design.html#light-use-of-traditional-oop"><i class="fa fa-check"></i><b>B.1.2</b> Light use of traditional OOP</a></li>
<li class="chapter" data-level="B.1.3" data-path="design.html"><a href="design.html#high-performant-small-objects"><i class="fa fa-check"></i><b>B.1.3</b> High-performant small objects</a></li>
<li class="chapter" data-level="B.1.4" data-path="design.html"><a href="design.html#fast-iteration-along-aggregated-data"><i class="fa fa-check"></i><b>B.1.4</b> Fast iteration along aggregated data</a></li>
<li class="chapter" data-level="B.1.5" data-path="design.html"><a href="design.html#access-to-information-across-targets"><i class="fa fa-check"></i><b>B.1.5</b> Access to information across targets</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="design.html"><a href="design.html#specific-classes"><i class="fa fa-check"></i><b>B.2</b> Specific classes</a>
<ul>
<li class="chapter" data-level="B.2.1" data-path="design.html"><a href="design.html#config"><i class="fa fa-check"></i><b>B.2.1</b> Config</a></li>
<li class="chapter" data-level="B.2.2" data-path="design.html"><a href="design.html#settings"><i class="fa fa-check"></i><b>B.2.2</b> Settings</a></li>
<li class="chapter" data-level="B.2.3" data-path="churn.html"><a href="churn.html#plan"><i class="fa fa-check"></i><b>B.2.3</b> Plan</a></li>
<li class="chapter" data-level="B.2.4" data-path="design.html"><a href="design.html#specification"><i class="fa fa-check"></i><b>B.2.4</b> Specification</a></li>
<li class="chapter" data-level="B.2.5" data-path="design.html"><a href="design.html#graph"><i class="fa fa-check"></i><b>B.2.5</b> Graph</a></li>
<li class="chapter" data-level="B.2.6" data-path="design.html"><a href="design.html#priority-queue"><i class="fa fa-check"></i><b>B.2.6</b> Priority queue</a></li>
<li class="chapter" data-level="B.2.7" data-path="design.html"><a href="design.html#metadata"><i class="fa fa-check"></i><b>B.2.7</b> Metadata</a></li>
<li class="chapter" data-level="B.2.8" data-path="design.html"><a href="design.html#cache"><i class="fa fa-check"></i><b>B.2.8</b> Cache</a></li>
<li class="chapter" data-level="B.2.9" data-path="design.html"><a href="design.html#code-analysis-lists"><i class="fa fa-check"></i><b>B.2.9</b> Code analysis lists</a></li>
<li class="chapter" data-level="B.2.10" data-path="design.html"><a href="design.html#environments"><i class="fa fa-check"></i><b>B.2.10</b> Environments</a></li>
<li class="chapter" data-level="B.2.11" data-path="design.html"><a href="design.html#hash-tables"><i class="fa fa-check"></i><b>B.2.11</b> Hash tables</a></li>
<li class="chapter" data-level="B.2.12" data-path="design.html"><a href="design.html#logger"><i class="fa fa-check"></i><b>B.2.12</b> Logger</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The drake R Package User Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dynamic" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Dynamic branching</h1>
<div id="a-note-about-versions" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> A note about versions</h2>
<p>The first release of dynamic branching was in <code>drake</code> version 7.8.0. In subsequent versions, dynamic branching behaves differently. This manual describes how dynamic branching works in development <code>drake</code> (to become version 7.9.0 in early January 2020). If you are using version 7.8.0, please refer to <a href="https://github.com/ropensci-books/drake/blob/c4dfa6dd71b5ffa4c6027633ae048d2ab0513c6d/dynamic.Rmd">this version of the chapter</a> instead.</p>
</div>
<div id="motivation" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Motivation</h2>
<p>In large workflows, you may need more targets than you can easily type in a plan, and you may not be able to fully specify all targets in advance. Dynamic branching is an interface to declare new targets while <code>make()</code> is running. It lets you create more compact plans and graphs, it is easier to use than <a href="static.html#static">static branching</a>, and it improves the startup speed of <code>make()</code> and friends.</p>
</div>
<div id="which-kind-of-branching-should-i-use" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Which kind of branching should I use?</h2>
<p>With dynamic branching, <code>make()</code> is faster to initialize, and you have far more flexibility. With <a href="static.html#static">static branching</a>, you have meaningful target names, and it is easier to predict what the plan is going to do in advance. There is a ton of room for overlap and personal judgement, and you can even use both kinds of branching together.</p>
</div>
<div id="dynamic-targets" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Dynamic targets</h2>
<p>A dynamic target is a <a href="https://vctrs.r-lib.org/">vector</a> of <em>sub-targets</em>. We let <code>make()</code> figure out which sub-targets to create and how to aggregate them.</p>
<p>As an example, let’s fit a regression model to each continent in <a href="https://github.com/jennybc/gapminder">Gapminder data</a>. To activate dynamic branching, use the <code>dynamic</code> argument of <code>target()</code>.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="dynamic.html#cb83-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb83-2"><a href="dynamic.html#cb83-2"></a><span class="kw">library</span>(drake)</span>
<span id="cb83-3"><a href="dynamic.html#cb83-3"></a><span class="kw">library</span>(gapminder)</span>
<span id="cb83-4"><a href="dynamic.html#cb83-4"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb83-5"><a href="dynamic.html#cb83-5"></a></span>
<span id="cb83-6"><a href="dynamic.html#cb83-6"></a><span class="co"># Split the Gapminder data by continent.</span></span>
<span id="cb83-7"><a href="dynamic.html#cb83-7"></a>gapminder_continents &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb83-8"><a href="dynamic.html#cb83-8"></a>  gapminder <span class="op">%&gt;%</span></span>
<span id="cb83-9"><a href="dynamic.html#cb83-9"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gdpPercap =</span> <span class="kw">scale</span>(gdpPercap)) <span class="op">%&gt;%</span></span>
<span id="cb83-10"><a href="dynamic.html#cb83-10"></a><span class="st">    </span><span class="kw">split</span>(<span class="dt">f =</span> .<span class="op">$</span>continent)</span>
<span id="cb83-11"><a href="dynamic.html#cb83-11"></a>}</span>
<span id="cb83-12"><a href="dynamic.html#cb83-12"></a></span>
<span id="cb83-13"><a href="dynamic.html#cb83-13"></a><span class="co"># Fit a model to a continent.</span></span>
<span id="cb83-14"><a href="dynamic.html#cb83-14"></a>fit_model &lt;-<span class="st"> </span><span class="cf">function</span>(continent_data) {</span>
<span id="cb83-15"><a href="dynamic.html#cb83-15"></a>  data &lt;-<span class="st"> </span>continent_data[[<span class="dv">1</span>]]</span>
<span id="cb83-16"><a href="dynamic.html#cb83-16"></a>  data <span class="op">%&gt;%</span></span>
<span id="cb83-17"><a href="dynamic.html#cb83-17"></a><span class="st">    </span><span class="kw">lm</span>(<span class="dt">formula =</span> gdpPercap <span class="op">~</span><span class="st"> </span>year) <span class="op">%&gt;%</span></span>
<span id="cb83-18"><a href="dynamic.html#cb83-18"></a><span class="st">    </span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb83-19"><a href="dynamic.html#cb83-19"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">continent =</span> data<span class="op">$</span>continent[<span class="dv">1</span>]) <span class="op">%&gt;%</span></span>
<span id="cb83-20"><a href="dynamic.html#cb83-20"></a><span class="st">    </span><span class="kw">select</span>(continent, term, statistic, p.value)</span>
<span id="cb83-21"><a href="dynamic.html#cb83-21"></a>}</span>
<span id="cb83-22"><a href="dynamic.html#cb83-22"></a></span>
<span id="cb83-23"><a href="dynamic.html#cb83-23"></a>plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</span>
<span id="cb83-24"><a href="dynamic.html#cb83-24"></a>  <span class="dt">continents =</span> <span class="kw">gapminder_continents</span>(),</span>
<span id="cb83-25"><a href="dynamic.html#cb83-25"></a>  <span class="dt">model =</span> <span class="kw">target</span>(<span class="kw">fit_model</span>(continents), <span class="dt">dynamic =</span> <span class="kw">map</span>(continents))</span>
<span id="cb83-26"><a href="dynamic.html#cb83-26"></a>)</span>
<span id="cb83-27"><a href="dynamic.html#cb83-27"></a></span>
<span id="cb83-28"><a href="dynamic.html#cb83-28"></a><span class="kw">make</span>(plan)</span>
<span id="cb83-29"><a href="dynamic.html#cb83-29"></a><span class="co">#&gt; [32m▶[39m target continents</span></span>
<span id="cb83-30"><a href="dynamic.html#cb83-30"></a><span class="co">#&gt; [32m▶[39m dynamic model</span></span>
<span id="cb83-31"><a href="dynamic.html#cb83-31"></a><span class="co">#&gt; [32m❯[39m subtarget model_c56e5407</span></span>
<span id="cb83-32"><a href="dynamic.html#cb83-32"></a><span class="co">#&gt; [32m❯[39m subtarget model_706a1529</span></span>
<span id="cb83-33"><a href="dynamic.html#cb83-33"></a><span class="co">#&gt; [32m❯[39m subtarget model_da843806</span></span>
<span id="cb83-34"><a href="dynamic.html#cb83-34"></a><span class="co">#&gt; [32m❯[39m subtarget model_862f8003</span></span>
<span id="cb83-35"><a href="dynamic.html#cb83-35"></a><span class="co">#&gt; [32m❯[39m subtarget model_ebb41f51</span></span>
<span id="cb83-36"><a href="dynamic.html#cb83-36"></a><span class="co">#&gt; [32m■[39m finalize model</span></span></code></pre></div>
<p>The data type of every sub-target is the same as the dynamic target it belongs to. In other words, <code>model</code> and <code>model_23022788</code> are both data frames, and <code>readd(model)</code> and friends automatically concatenate all the <code>model_*</code> sub-targets.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="dynamic.html#cb84-1"></a><span class="kw">readd</span>(model)</span>
<span id="cb84-2"><a href="dynamic.html#cb84-2"></a><span class="co">#&gt; [90m# A tibble: 10 x 4[39m</span></span>
<span id="cb84-3"><a href="dynamic.html#cb84-3"></a><span class="co">#&gt;    continent term        statistic  p.value</span></span>
<span id="cb84-4"><a href="dynamic.html#cb84-4"></a><span class="co">#&gt;    [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb84-5"><a href="dynamic.html#cb84-5"></a><span class="co">#&gt; [90m 1[39m Africa    (Intercept)     -[31m4[39m[31m.[39m[31m44[39m 1.08[90me[39m[31m- 5[39m</span></span>
<span id="cb84-6"><a href="dynamic.html#cb84-6"></a><span class="co">#&gt; [90m 2[39m Africa    year             4.04 5.90[90me[39m[31m- 5[39m</span></span>
<span id="cb84-7"><a href="dynamic.html#cb84-7"></a><span class="co">#&gt; [90m 3[39m Americas  (Intercept)     -[31m5[39m[31m.[39m[31m56[39m 6.10[90me[39m[31m- 8[39m</span></span>
<span id="cb84-8"><a href="dynamic.html#cb84-8"></a><span class="co">#&gt; [90m 4[39m Americas  year             5.55 6.16[90me[39m[31m- 8[39m</span></span>
<span id="cb84-9"><a href="dynamic.html#cb84-9"></a><span class="co">#&gt; [90m 5[39m Asia      (Intercept)     -[31m2[39m[31m.[39m[31m74[39m 6.39[90me[39m[31m- 3[39m</span></span>
<span id="cb84-10"><a href="dynamic.html#cb84-10"></a><span class="co">#&gt; [90m 6[39m Asia      year             2.75 6.23[90me[39m[31m- 3[39m</span></span>
<span id="cb84-11"><a href="dynamic.html#cb84-11"></a><span class="co">#&gt; [90m 7[39m Europe    (Intercept)    -[31m14[39m[31m.[39m[31m4[39m  3.12[90me[39m[31m-37[39m</span></span>
<span id="cb84-12"><a href="dynamic.html#cb84-12"></a><span class="co">#&gt; [90m 8[39m Europe    year            14.5  7.06[90me[39m[31m-38[39m</span></span>
<span id="cb84-13"><a href="dynamic.html#cb84-13"></a><span class="co">#&gt; [90m 9[39m Oceania   (Intercept)    -[31m11[39m[31m.[39m[31m3[39m  1.32[90me[39m[31m-10[39m</span></span>
<span id="cb84-14"><a href="dynamic.html#cb84-14"></a><span class="co">#&gt; [90m10[39m Oceania   year            11.5  9.48[90me[39m[31m-11[39m</span></span></code></pre></div>
<p>This behavior is powered by the <a href="https://vctrs.r-lib.org/"><code>vctrs</code></a>. A dynamic target like <code>model</code> above is really a “<code>vctr</code>” of sub-targets. Under the hood, the aggregated value of <code>model</code> is what you get from calling <code>vec_c()</code> on all the <code>model_*</code> sub-targets. When you dynamically <code>map()</code> over a non-dynamic object, you are taking slices with <code>vec_slice()</code>. (When you <code>map()</code> over a dynamic target, each element is a sub-target and <code>vec_slice()</code> is not necessary.)</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="dynamic.html#cb85-1"></a><span class="kw">library</span>(vctrs)</span>
<span id="cb85-2"><a href="dynamic.html#cb85-2"></a></span>
<span id="cb85-3"><a href="dynamic.html#cb85-3"></a><span class="co"># same as readd(model)</span></span>
<span id="cb85-4"><a href="dynamic.html#cb85-4"></a>s &lt;-<span class="st"> </span><span class="kw">subtargets</span>(model)</span>
<span id="cb85-5"><a href="dynamic.html#cb85-5"></a><span class="kw">vec_c</span>(</span>
<span id="cb85-6"><a href="dynamic.html#cb85-6"></a>  <span class="kw">readd</span>(s[<span class="dv">1</span>], <span class="dt">character_only =</span> <span class="ot">TRUE</span>),</span>
<span id="cb85-7"><a href="dynamic.html#cb85-7"></a>  <span class="kw">readd</span>(s[<span class="dv">2</span>], <span class="dt">character_only =</span> <span class="ot">TRUE</span>),</span>
<span id="cb85-8"><a href="dynamic.html#cb85-8"></a>  <span class="kw">readd</span>(s[<span class="dv">3</span>], <span class="dt">character_only =</span> <span class="ot">TRUE</span>),</span>
<span id="cb85-9"><a href="dynamic.html#cb85-9"></a>  <span class="kw">readd</span>(s[<span class="dv">4</span>], <span class="dt">character_only =</span> <span class="ot">TRUE</span>),</span>
<span id="cb85-10"><a href="dynamic.html#cb85-10"></a>  <span class="kw">readd</span>(s[<span class="dv">5</span>], <span class="dt">character_only =</span> <span class="ot">TRUE</span>)</span>
<span id="cb85-11"><a href="dynamic.html#cb85-11"></a>)</span>
<span id="cb85-12"><a href="dynamic.html#cb85-12"></a><span class="co">#&gt; [90m# A tibble: 10 x 4[39m</span></span>
<span id="cb85-13"><a href="dynamic.html#cb85-13"></a><span class="co">#&gt;    continent term        statistic  p.value</span></span>
<span id="cb85-14"><a href="dynamic.html#cb85-14"></a><span class="co">#&gt;    [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb85-15"><a href="dynamic.html#cb85-15"></a><span class="co">#&gt; [90m 1[39m Africa    (Intercept)     -[31m4[39m[31m.[39m[31m44[39m 1.08[90me[39m[31m- 5[39m</span></span>
<span id="cb85-16"><a href="dynamic.html#cb85-16"></a><span class="co">#&gt; [90m 2[39m Africa    year             4.04 5.90[90me[39m[31m- 5[39m</span></span>
<span id="cb85-17"><a href="dynamic.html#cb85-17"></a><span class="co">#&gt; [90m 3[39m Americas  (Intercept)     -[31m5[39m[31m.[39m[31m56[39m 6.10[90me[39m[31m- 8[39m</span></span>
<span id="cb85-18"><a href="dynamic.html#cb85-18"></a><span class="co">#&gt; [90m 4[39m Americas  year             5.55 6.16[90me[39m[31m- 8[39m</span></span>
<span id="cb85-19"><a href="dynamic.html#cb85-19"></a><span class="co">#&gt; [90m 5[39m Asia      (Intercept)     -[31m2[39m[31m.[39m[31m74[39m 6.39[90me[39m[31m- 3[39m</span></span>
<span id="cb85-20"><a href="dynamic.html#cb85-20"></a><span class="co">#&gt; [90m 6[39m Asia      year             2.75 6.23[90me[39m[31m- 3[39m</span></span>
<span id="cb85-21"><a href="dynamic.html#cb85-21"></a><span class="co">#&gt; [90m 7[39m Europe    (Intercept)    -[31m14[39m[31m.[39m[31m4[39m  3.12[90me[39m[31m-37[39m</span></span>
<span id="cb85-22"><a href="dynamic.html#cb85-22"></a><span class="co">#&gt; [90m 8[39m Europe    year            14.5  7.06[90me[39m[31m-38[39m</span></span>
<span id="cb85-23"><a href="dynamic.html#cb85-23"></a><span class="co">#&gt; [90m 9[39m Oceania   (Intercept)    -[31m11[39m[31m.[39m[31m3[39m  1.32[90me[39m[31m-10[39m</span></span>
<span id="cb85-24"><a href="dynamic.html#cb85-24"></a><span class="co">#&gt; [90m10[39m Oceania   year            11.5  9.48[90me[39m[31m-11[39m</span></span>
<span id="cb85-25"><a href="dynamic.html#cb85-25"></a></span>
<span id="cb85-26"><a href="dynamic.html#cb85-26"></a><span class="kw">loadd</span>(model)</span>
<span id="cb85-27"><a href="dynamic.html#cb85-27"></a></span>
<span id="cb85-28"><a href="dynamic.html#cb85-28"></a><span class="co"># Second slice if you were to map() over mtcars.</span></span>
<span id="cb85-29"><a href="dynamic.html#cb85-29"></a><span class="kw">vec_slice</span>(mtcars, <span class="dv">2</span>)</span>
<span id="cb85-30"><a href="dynamic.html#cb85-30"></a><span class="co">#&gt;               mpg cyl disp  hp drat    wt  qsec vs am gear carb</span></span>
<span id="cb85-31"><a href="dynamic.html#cb85-31"></a><span class="co">#&gt; Mazda RX4 Wag  21   6  160 110  3.9 2.875 17.02  0  1    4    4</span></span>
<span id="cb85-32"><a href="dynamic.html#cb85-32"></a></span>
<span id="cb85-33"><a href="dynamic.html#cb85-33"></a><span class="co"># Fifth slice if you were to map() over letters.</span></span>
<span id="cb85-34"><a href="dynamic.html#cb85-34"></a><span class="kw">vec_slice</span>(letters, <span class="dv">5</span>)</span>
<span id="cb85-35"><a href="dynamic.html#cb85-35"></a><span class="co">#&gt; [1] &quot;e&quot;</span></span></code></pre></div>
<p>You can use <code>vec_c()</code> and <code>vec_slice()</code> to anticipate edge cases in dynamic branching.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="dynamic.html#cb86-1"></a><span class="co"># If you map() over a list, each sub-target is a single-element list.</span></span>
<span id="cb86-2"><a href="dynamic.html#cb86-2"></a><span class="kw">vec_slice</span>(<span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dv">1</span>)</span>
<span id="cb86-3"><a href="dynamic.html#cb86-3"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb86-4"><a href="dynamic.html#cb86-4"></a><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="dynamic.html#cb87-1"></a><span class="co"># If each sub-target has multiple elements,</span></span>
<span id="cb87-2"><a href="dynamic.html#cb87-2"></a><span class="co"># the aggregated target (e.g. from readd())</span></span>
<span id="cb87-3"><a href="dynamic.html#cb87-3"></a><span class="co"># will have more elements than sub-targets.</span></span>
<span id="cb87-4"><a href="dynamic.html#cb87-4"></a>subtarget1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb87-5"><a href="dynamic.html#cb87-5"></a>subtarget2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb87-6"><a href="dynamic.html#cb87-6"></a><span class="kw">vec_c</span>(subtarget1, subtarget2)</span>
<span id="cb87-7"><a href="dynamic.html#cb87-7"></a><span class="co">#&gt; [1] 1 2 3 4</span></span></code></pre></div>
<p>Back in our plan, <code>target(fit_model(continents), dynamic = map(continents))</code> is equivalent to commands <code>fit_model(continents[1])</code> through <code>fit_model(continents[5])</code>. Since <code>continents</code> is really a list of data frames, <code>continents[1]</code> through <code>continents[5]</code> are also lists of data frames, which is why we need the line <code>data &lt;- continent_data[[1]]</code> in <code>fit_model()</code>.</p>
<p>To post-process our models, we can work with either the individual sub-targets or the whole vector of all the models. Below, <code>year</code> uses the former and <code>intercept</code> uses the latter.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="dynamic.html#cb88-1"></a>plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</span>
<span id="cb88-2"><a href="dynamic.html#cb88-2"></a>  <span class="dt">continents =</span> <span class="kw">gapminder_continents</span>(),</span>
<span id="cb88-3"><a href="dynamic.html#cb88-3"></a>  <span class="dt">model =</span> <span class="kw">target</span>(<span class="kw">fit_model</span>(continents), <span class="dt">dynamic =</span> <span class="kw">map</span>(continents)),</span>
<span id="cb88-4"><a href="dynamic.html#cb88-4"></a>  <span class="co"># Filter each model individually:</span></span>
<span id="cb88-5"><a href="dynamic.html#cb88-5"></a>  <span class="dt">year =</span> <span class="kw">target</span>(<span class="kw">filter</span>(model, term <span class="op">==</span><span class="st"> &quot;year&quot;</span>), <span class="dt">dynamic =</span> <span class="kw">map</span>(model)),</span>
<span id="cb88-6"><a href="dynamic.html#cb88-6"></a>  <span class="co"># Aggregate all the models, then filter the whole vector:</span></span>
<span id="cb88-7"><a href="dynamic.html#cb88-7"></a>  <span class="dt">intercept =</span> <span class="kw">filter</span>(model, term <span class="op">!=</span><span class="st"> &quot;year&quot;</span>)</span>
<span id="cb88-8"><a href="dynamic.html#cb88-8"></a>)</span>
<span id="cb88-9"><a href="dynamic.html#cb88-9"></a></span>
<span id="cb88-10"><a href="dynamic.html#cb88-10"></a><span class="kw">make</span>(plan)</span>
<span id="cb88-11"><a href="dynamic.html#cb88-11"></a><span class="co">#&gt; [34mℹ[39m unloading 1 targets from environment</span></span>
<span id="cb88-12"><a href="dynamic.html#cb88-12"></a><span class="co">#&gt; [32m▶[39m target intercept</span></span>
<span id="cb88-13"><a href="dynamic.html#cb88-13"></a><span class="co">#&gt; [32m▶[39m dynamic year</span></span>
<span id="cb88-14"><a href="dynamic.html#cb88-14"></a><span class="co">#&gt; [32m❯[39m subtarget year_20cb8ecb</span></span>
<span id="cb88-15"><a href="dynamic.html#cb88-15"></a><span class="co">#&gt; [32m❯[39m subtarget year_f7502c3e</span></span>
<span id="cb88-16"><a href="dynamic.html#cb88-16"></a><span class="co">#&gt; [32m❯[39m subtarget year_a22d53f2</span></span>
<span id="cb88-17"><a href="dynamic.html#cb88-17"></a><span class="co">#&gt; [32m❯[39m subtarget year_1facb02b</span></span>
<span id="cb88-18"><a href="dynamic.html#cb88-18"></a><span class="co">#&gt; [32m❯[39m subtarget year_399fff25</span></span>
<span id="cb88-19"><a href="dynamic.html#cb88-19"></a><span class="co">#&gt; [32m■[39m finalize year</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="dynamic.html#cb89-1"></a><span class="kw">readd</span>(year)</span>
<span id="cb89-2"><a href="dynamic.html#cb89-2"></a><span class="co">#&gt; [90m# A tibble: 5 x 4[39m</span></span>
<span id="cb89-3"><a href="dynamic.html#cb89-3"></a><span class="co">#&gt;   continent term  statistic  p.value</span></span>
<span id="cb89-4"><a href="dynamic.html#cb89-4"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb89-5"><a href="dynamic.html#cb89-5"></a><span class="co">#&gt; [90m1[39m Africa    year       4.04 5.90[90me[39m[31m- 5[39m</span></span>
<span id="cb89-6"><a href="dynamic.html#cb89-6"></a><span class="co">#&gt; [90m2[39m Americas  year       5.55 6.16[90me[39m[31m- 8[39m</span></span>
<span id="cb89-7"><a href="dynamic.html#cb89-7"></a><span class="co">#&gt; [90m3[39m Asia      year       2.75 6.23[90me[39m[31m- 3[39m</span></span>
<span id="cb89-8"><a href="dynamic.html#cb89-8"></a><span class="co">#&gt; [90m4[39m Europe    year      14.5  7.06[90me[39m[31m-38[39m</span></span>
<span id="cb89-9"><a href="dynamic.html#cb89-9"></a><span class="co">#&gt; [90m5[39m Oceania   year      11.5  9.48[90me[39m[31m-11[39m</span></span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="dynamic.html#cb90-1"></a><span class="kw">readd</span>(intercept)</span>
<span id="cb90-2"><a href="dynamic.html#cb90-2"></a><span class="co">#&gt; [90m# A tibble: 5 x 4[39m</span></span>
<span id="cb90-3"><a href="dynamic.html#cb90-3"></a><span class="co">#&gt;   continent term        statistic  p.value</span></span>
<span id="cb90-4"><a href="dynamic.html#cb90-4"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb90-5"><a href="dynamic.html#cb90-5"></a><span class="co">#&gt; [90m1[39m Africa    (Intercept)     -[31m4[39m[31m.[39m[31m44[39m 1.08[90me[39m[31m- 5[39m</span></span>
<span id="cb90-6"><a href="dynamic.html#cb90-6"></a><span class="co">#&gt; [90m2[39m Americas  (Intercept)     -[31m5[39m[31m.[39m[31m56[39m 6.10[90me[39m[31m- 8[39m</span></span>
<span id="cb90-7"><a href="dynamic.html#cb90-7"></a><span class="co">#&gt; [90m3[39m Asia      (Intercept)     -[31m2[39m[31m.[39m[31m74[39m 6.39[90me[39m[31m- 3[39m</span></span>
<span id="cb90-8"><a href="dynamic.html#cb90-8"></a><span class="co">#&gt; [90m4[39m Europe    (Intercept)    -[31m14[39m[31m.[39m[31m4[39m  3.12[90me[39m[31m-37[39m</span></span>
<span id="cb90-9"><a href="dynamic.html#cb90-9"></a><span class="co">#&gt; [90m5[39m Oceania   (Intercept)    -[31m11[39m[31m.[39m[31m3[39m  1.32[90me[39m[31m-10[39m</span></span></code></pre></div>
<p>If automatic concatenation of sub-targets is confusing (e.g. if some sub-targets are <code>NULL</code>, as in <a href="https://github.com/ropensci-books/drake/issues/142" class="uri">https://github.com/ropensci-books/drake/issues/142</a>) you can read the dynamic target as a named list (only in <code>drake</code> version 7.10.0 and above).</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="dynamic.html#cb91-1"></a><span class="kw">readd</span>(model, <span class="dt">subtarget_list =</span> <span class="ot">TRUE</span>) <span class="co"># Requires drake &gt;= 7.10.0.</span></span>
<span id="cb91-2"><a href="dynamic.html#cb91-2"></a><span class="co">#&gt; $model_c56e5407</span></span>
<span id="cb91-3"><a href="dynamic.html#cb91-3"></a><span class="co">#&gt; [90m# A tibble: 2 x 4[39m</span></span>
<span id="cb91-4"><a href="dynamic.html#cb91-4"></a><span class="co">#&gt;   continent term        statistic   p.value</span></span>
<span id="cb91-5"><a href="dynamic.html#cb91-5"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb91-6"><a href="dynamic.html#cb91-6"></a><span class="co">#&gt; [90m1[39m Africa    (Intercept)     -[31m4[39m[31m.[39m[31m44[39m 0.000[4m0[24m[4m1[24m[4m0[24m8</span></span>
<span id="cb91-7"><a href="dynamic.html#cb91-7"></a><span class="co">#&gt; [90m2[39m Africa    year             4.04 0.000[4m0[24m[4m5[24m[4m9[24m0</span></span>
<span id="cb91-8"><a href="dynamic.html#cb91-8"></a><span class="co">#&gt; </span></span>
<span id="cb91-9"><a href="dynamic.html#cb91-9"></a><span class="co">#&gt; $model_706a1529</span></span>
<span id="cb91-10"><a href="dynamic.html#cb91-10"></a><span class="co">#&gt; [90m# A tibble: 2 x 4[39m</span></span>
<span id="cb91-11"><a href="dynamic.html#cb91-11"></a><span class="co">#&gt;   continent term        statistic      p.value</span></span>
<span id="cb91-12"><a href="dynamic.html#cb91-12"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m        [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb91-13"><a href="dynamic.html#cb91-13"></a><span class="co">#&gt; [90m1[39m Americas  (Intercept)     -[31m5[39m[31m.[39m[31m56[39m 0.000[4m0[24m[4m0[24m[4m0[24m061[4m0[24m</span></span>
<span id="cb91-14"><a href="dynamic.html#cb91-14"></a><span class="co">#&gt; [90m2[39m Americas  year             5.55 0.000[4m0[24m[4m0[24m[4m0[24m061[4m6[24m</span></span>
<span id="cb91-15"><a href="dynamic.html#cb91-15"></a><span class="co">#&gt; </span></span>
<span id="cb91-16"><a href="dynamic.html#cb91-16"></a><span class="co">#&gt; $model_da843806</span></span>
<span id="cb91-17"><a href="dynamic.html#cb91-17"></a><span class="co">#&gt; [90m# A tibble: 2 x 4[39m</span></span>
<span id="cb91-18"><a href="dynamic.html#cb91-18"></a><span class="co">#&gt;   continent term        statistic p.value</span></span>
<span id="cb91-19"><a href="dynamic.html#cb91-19"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb91-20"><a href="dynamic.html#cb91-20"></a><span class="co">#&gt; [90m1[39m Asia      (Intercept)     -[31m2[39m[31m.[39m[31m74[39m 0.006[4m3[24m[4m9[24m</span></span>
<span id="cb91-21"><a href="dynamic.html#cb91-21"></a><span class="co">#&gt; [90m2[39m Asia      year             2.75 0.006[4m2[24m[4m3[24m</span></span>
<span id="cb91-22"><a href="dynamic.html#cb91-22"></a><span class="co">#&gt; </span></span>
<span id="cb91-23"><a href="dynamic.html#cb91-23"></a><span class="co">#&gt; $model_862f8003</span></span>
<span id="cb91-24"><a href="dynamic.html#cb91-24"></a><span class="co">#&gt; [90m# A tibble: 2 x 4[39m</span></span>
<span id="cb91-25"><a href="dynamic.html#cb91-25"></a><span class="co">#&gt;   continent term        statistic  p.value</span></span>
<span id="cb91-26"><a href="dynamic.html#cb91-26"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb91-27"><a href="dynamic.html#cb91-27"></a><span class="co">#&gt; [90m1[39m Europe    (Intercept)     -[31m14[39m[31m.[39m[31m4[39m 3.12[90me[39m[31m-37[39m</span></span>
<span id="cb91-28"><a href="dynamic.html#cb91-28"></a><span class="co">#&gt; [90m2[39m Europe    year             14.5 7.06[90me[39m[31m-38[39m</span></span>
<span id="cb91-29"><a href="dynamic.html#cb91-29"></a><span class="co">#&gt; </span></span>
<span id="cb91-30"><a href="dynamic.html#cb91-30"></a><span class="co">#&gt; $model_ebb41f51</span></span>
<span id="cb91-31"><a href="dynamic.html#cb91-31"></a><span class="co">#&gt; [90m# A tibble: 2 x 4[39m</span></span>
<span id="cb91-32"><a href="dynamic.html#cb91-32"></a><span class="co">#&gt;   continent term        statistic  p.value</span></span>
<span id="cb91-33"><a href="dynamic.html#cb91-33"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb91-34"><a href="dynamic.html#cb91-34"></a><span class="co">#&gt; [90m1[39m Oceania   (Intercept)     -[31m11[39m[31m.[39m[31m3[39m 1.32[90me[39m[31m-10[39m</span></span>
<span id="cb91-35"><a href="dynamic.html#cb91-35"></a><span class="co">#&gt; [90m2[39m Oceania   year             11.5 9.48[90me[39m[31m-11[39m</span></span></code></pre></div>
<p>Alternatively, you can work with the individual sub-targets.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="dynamic.html#cb92-1"></a><span class="kw">subtargets</span>(model)</span>
<span id="cb92-2"><a href="dynamic.html#cb92-2"></a><span class="co">#&gt; [1] &quot;model_c56e5407&quot; &quot;model_706a1529&quot; &quot;model_da843806&quot; &quot;model_862f8003&quot;</span></span>
<span id="cb92-3"><a href="dynamic.html#cb92-3"></a><span class="co">#&gt; [5] &quot;model_ebb41f51&quot;</span></span>
<span id="cb92-4"><a href="dynamic.html#cb92-4"></a></span>
<span id="cb92-5"><a href="dynamic.html#cb92-5"></a><span class="kw">readd</span>(model, <span class="dt">subtargets =</span> <span class="dv">1</span>) <span class="co"># equivalent to readd() on a single model_* sub-target</span></span>
<span id="cb92-6"><a href="dynamic.html#cb92-6"></a><span class="co">#&gt; [90m# A tibble: 2 x 4[39m</span></span>
<span id="cb92-7"><a href="dynamic.html#cb92-7"></a><span class="co">#&gt;   continent term        statistic   p.value</span></span>
<span id="cb92-8"><a href="dynamic.html#cb92-8"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb92-9"><a href="dynamic.html#cb92-9"></a><span class="co">#&gt; [90m1[39m Africa    (Intercept)     -[31m4[39m[31m.[39m[31m44[39m 0.000[4m0[24m[4m1[24m[4m0[24m8</span></span>
<span id="cb92-10"><a href="dynamic.html#cb92-10"></a><span class="co">#&gt; [90m2[39m Africa    year             4.04 0.000[4m0[24m[4m5[24m[4m9[24m0</span></span></code></pre></div>
</div>
<div id="dynamic-transformations" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Dynamic transformations</h2>
<p>Dynamic branching supports transformations <code>map()</code>, <code>cross()</code>, and <code>group()</code>. These transformations tell <code>drake</code> how to create sub-targets.</p>
<div id="map" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> <code>map()</code></h3>
<p><code>map()</code> iterates over the <a href="https://vctrs.r-lib.org/reference/vec_slice.html">vector slices</a> of the targets you supply as arguments. We saw above how <code>map()</code> iterates over lists. If you give it a data frame, it will map over the rows.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="dynamic.html#cb93-1"></a>plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</span>
<span id="cb93-2"><a href="dynamic.html#cb93-2"></a>  <span class="dt">subset =</span> <span class="kw">head</span>(gapminder),</span>
<span id="cb93-3"><a href="dynamic.html#cb93-3"></a>  <span class="dt">row =</span> <span class="kw">target</span>(subset, <span class="dt">dynamic =</span> <span class="kw">map</span>(subset))</span>
<span id="cb93-4"><a href="dynamic.html#cb93-4"></a>)</span>
<span id="cb93-5"><a href="dynamic.html#cb93-5"></a></span>
<span id="cb93-6"><a href="dynamic.html#cb93-6"></a><span class="kw">make</span>(plan)</span>
<span id="cb93-7"><a href="dynamic.html#cb93-7"></a><span class="co">#&gt; [32m▶[39m target subset</span></span>
<span id="cb93-8"><a href="dynamic.html#cb93-8"></a><span class="co">#&gt; [32m▶[39m dynamic row</span></span>
<span id="cb93-9"><a href="dynamic.html#cb93-9"></a><span class="co">#&gt; [32m❯[39m subtarget row_9939cae3</span></span>
<span id="cb93-10"><a href="dynamic.html#cb93-10"></a><span class="co">#&gt; [32m❯[39m subtarget row_e8047114</span></span>
<span id="cb93-11"><a href="dynamic.html#cb93-11"></a><span class="co">#&gt; [32m❯[39m subtarget row_2ef3db10</span></span>
<span id="cb93-12"><a href="dynamic.html#cb93-12"></a><span class="co">#&gt; [32m❯[39m subtarget row_f9171bbe</span></span>
<span id="cb93-13"><a href="dynamic.html#cb93-13"></a><span class="co">#&gt; [32m❯[39m subtarget row_7d6002e9</span></span>
<span id="cb93-14"><a href="dynamic.html#cb93-14"></a><span class="co">#&gt; [32m❯[39m subtarget row_509468b3</span></span>
<span id="cb93-15"><a href="dynamic.html#cb93-15"></a><span class="co">#&gt; [32m■[39m finalize row</span></span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="dynamic.html#cb94-1"></a><span class="kw">readd</span>(row_9939cae3)</span>
<span id="cb94-2"><a href="dynamic.html#cb94-2"></a><span class="co">#&gt; [90m# A tibble: 1 x 6[39m</span></span>
<span id="cb94-3"><a href="dynamic.html#cb94-3"></a><span class="co">#&gt;   country     continent  year lifeExp     pop gdpPercap</span></span>
<span id="cb94-4"><a href="dynamic.html#cb94-4"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m       [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;int&gt;[39m[23m   [3m[90m&lt;dbl&gt;[39m[23m   [3m[90m&lt;int&gt;[39m[23m     [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb94-5"><a href="dynamic.html#cb94-5"></a><span class="co">#&gt; [90m1[39m Afghanistan Asia       [4m1[24m952    28.8 8[4m4[24m[4m2[24m[4m5[24m333      779.</span></span></code></pre></div>
<p>If you supply multiple targets, <code>map()</code> iterates over the slices of each.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="dynamic.html#cb95-1"></a>plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</span>
<span id="cb95-2"><a href="dynamic.html#cb95-2"></a>  <span class="dt">numbers =</span> <span class="kw">seq_len</span>(<span class="dv">2</span>),</span>
<span id="cb95-3"><a href="dynamic.html#cb95-3"></a>  <span class="dt">letters =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>),</span>
<span id="cb95-4"><a href="dynamic.html#cb95-4"></a>  <span class="dt">zipped =</span> <span class="kw">target</span>(<span class="kw">paste0</span>(numbers, letters), <span class="dt">dynamic =</span> <span class="kw">map</span>(numbers, letters))</span>
<span id="cb95-5"><a href="dynamic.html#cb95-5"></a>)</span>
<span id="cb95-6"><a href="dynamic.html#cb95-6"></a></span>
<span id="cb95-7"><a href="dynamic.html#cb95-7"></a><span class="kw">make</span>(plan)</span>
<span id="cb95-8"><a href="dynamic.html#cb95-8"></a><span class="co">#&gt; [32m▶[39m target numbers</span></span>
<span id="cb95-9"><a href="dynamic.html#cb95-9"></a><span class="co">#&gt; [32m▶[39m target letters</span></span>
<span id="cb95-10"><a href="dynamic.html#cb95-10"></a><span class="co">#&gt; [32m▶[39m dynamic zipped</span></span>
<span id="cb95-11"><a href="dynamic.html#cb95-11"></a><span class="co">#&gt; [32m❯[39m subtarget zipped_8ac3968c</span></span>
<span id="cb95-12"><a href="dynamic.html#cb95-12"></a><span class="co">#&gt; [32m❯[39m subtarget zipped_4a7a9b07</span></span>
<span id="cb95-13"><a href="dynamic.html#cb95-13"></a><span class="co">#&gt; [32m■[39m finalize zipped</span></span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="dynamic.html#cb96-1"></a><span class="kw">readd</span>(zipped)</span>
<span id="cb96-2"><a href="dynamic.html#cb96-2"></a><span class="co">#&gt; [1] &quot;1a&quot; &quot;2b&quot;</span></span></code></pre></div>
</div>
<div id="cross" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> <code>cross()</code></h3>
<p><code>cross()</code> creates a new sub-target for each combination of targets you supply as arguments.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="dynamic.html#cb97-1"></a>plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</span>
<span id="cb97-2"><a href="dynamic.html#cb97-2"></a>  <span class="dt">numbers =</span> <span class="kw">seq_len</span>(<span class="dv">2</span>),</span>
<span id="cb97-3"><a href="dynamic.html#cb97-3"></a>  <span class="dt">letters =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>),</span>
<span id="cb97-4"><a href="dynamic.html#cb97-4"></a>  <span class="dt">combo =</span> <span class="kw">target</span>(<span class="kw">paste0</span>(numbers, letters), <span class="dt">dynamic =</span> <span class="kw">cross</span>(numbers, letters))</span>
<span id="cb97-5"><a href="dynamic.html#cb97-5"></a>)</span>
<span id="cb97-6"><a href="dynamic.html#cb97-6"></a></span>
<span id="cb97-7"><a href="dynamic.html#cb97-7"></a><span class="kw">make</span>(plan)</span>
<span id="cb97-8"><a href="dynamic.html#cb97-8"></a><span class="co">#&gt; [32m▶[39m dynamic combo</span></span>
<span id="cb97-9"><a href="dynamic.html#cb97-9"></a><span class="co">#&gt; [32m❯[39m subtarget combo_8ac3968c</span></span>
<span id="cb97-10"><a href="dynamic.html#cb97-10"></a><span class="co">#&gt; [32m❯[39m subtarget combo_ed1d2e7b</span></span>
<span id="cb97-11"><a href="dynamic.html#cb97-11"></a><span class="co">#&gt; [32m❯[39m subtarget combo_ef37ab56</span></span>
<span id="cb97-12"><a href="dynamic.html#cb97-12"></a><span class="co">#&gt; [32m❯[39m subtarget combo_4a7a9b07</span></span>
<span id="cb97-13"><a href="dynamic.html#cb97-13"></a><span class="co">#&gt; [32m■[39m finalize combo</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="dynamic.html#cb98-1"></a><span class="kw">readd</span>(combo)</span>
<span id="cb98-2"><a href="dynamic.html#cb98-2"></a><span class="co">#&gt; [1] &quot;1a&quot; &quot;1b&quot; &quot;2a&quot; &quot;2b&quot;</span></span></code></pre></div>
</div>
<div id="group" class="section level3" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> <code>group()</code></h3>
<p>With <code>group()</code>, you can create multiple aggregates of a given target. Use the <code>.by</code> argument to set a grouping variable.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="dynamic.html#cb99-1"></a>plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</span>
<span id="cb99-2"><a href="dynamic.html#cb99-2"></a>  <span class="dt">data =</span> gapminder,</span>
<span id="cb99-3"><a href="dynamic.html#cb99-3"></a>  <span class="dt">by =</span> data<span class="op">$</span>continent,</span>
<span id="cb99-4"><a href="dynamic.html#cb99-4"></a>  <span class="dt">gdp =</span> <span class="kw">target</span>(</span>
<span id="cb99-5"><a href="dynamic.html#cb99-5"></a>    <span class="kw">tibble</span>(<span class="dt">median =</span> <span class="kw">median</span>(data<span class="op">$</span>gdpPercap), <span class="dt">continent =</span> by[<span class="dv">1</span>]),</span>
<span id="cb99-6"><a href="dynamic.html#cb99-6"></a>    <span class="dt">dynamic =</span> <span class="kw">group</span>(data, <span class="dt">.by =</span> by)</span>
<span id="cb99-7"><a href="dynamic.html#cb99-7"></a>  )</span>
<span id="cb99-8"><a href="dynamic.html#cb99-8"></a>)</span>
<span id="cb99-9"><a href="dynamic.html#cb99-9"></a></span>
<span id="cb99-10"><a href="dynamic.html#cb99-10"></a><span class="kw">make</span>(plan)</span>
<span id="cb99-11"><a href="dynamic.html#cb99-11"></a><span class="co">#&gt; [32m▶[39m target data</span></span>
<span id="cb99-12"><a href="dynamic.html#cb99-12"></a><span class="co">#&gt; [32m▶[39m target by</span></span>
<span id="cb99-13"><a href="dynamic.html#cb99-13"></a><span class="co">#&gt; [32m▶[39m dynamic gdp</span></span>
<span id="cb99-14"><a href="dynamic.html#cb99-14"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_9adfc39f</span></span>
<span id="cb99-15"><a href="dynamic.html#cb99-15"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_d9f30951</span></span>
<span id="cb99-16"><a href="dynamic.html#cb99-16"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_958a2f81</span></span>
<span id="cb99-17"><a href="dynamic.html#cb99-17"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_962b03c8</span></span>
<span id="cb99-18"><a href="dynamic.html#cb99-18"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_dc1cff81</span></span>
<span id="cb99-19"><a href="dynamic.html#cb99-19"></a><span class="co">#&gt; [32m■[39m finalize gdp</span></span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="dynamic.html#cb100-1"></a><span class="kw">readd</span>(gdp)</span>
<span id="cb100-2"><a href="dynamic.html#cb100-2"></a><span class="co">#&gt; [90m# A tibble: 5 x 2[39m</span></span>
<span id="cb100-3"><a href="dynamic.html#cb100-3"></a><span class="co">#&gt;   median continent</span></span>
<span id="cb100-4"><a href="dynamic.html#cb100-4"></a><span class="co">#&gt;    [3m[90m&lt;dbl&gt;[39m[23m [3m[90m&lt;fct&gt;[39m[23m    </span></span>
<span id="cb100-5"><a href="dynamic.html#cb100-5"></a><span class="co">#&gt; [90m1[39m  [4m2[24m647. Asia     </span></span>
<span id="cb100-6"><a href="dynamic.html#cb100-6"></a><span class="co">#&gt; [90m2[39m [4m1[24m[4m2[24m082. Europe   </span></span>
<span id="cb100-7"><a href="dynamic.html#cb100-7"></a><span class="co">#&gt; [90m3[39m  [4m1[24m192. Africa   </span></span>
<span id="cb100-8"><a href="dynamic.html#cb100-8"></a><span class="co">#&gt; [90m4[39m  [4m5[24m466. Americas </span></span>
<span id="cb100-9"><a href="dynamic.html#cb100-9"></a><span class="co">#&gt; [90m5[39m [4m1[24m[4m7[24m983. Oceania</span></span></code></pre></div>
</div>
</div>
<div id="trace" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Trace</h2>
<p>All dynamic transforms have a <code>.trace</code> argument to record optional metadata for each sub-target. In the example from <code>group()</code>, the trace is another way to keep track of the continent of each median GDP value.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="dynamic.html#cb101-1"></a>plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</span>
<span id="cb101-2"><a href="dynamic.html#cb101-2"></a>  <span class="dt">data =</span> gapminder,</span>
<span id="cb101-3"><a href="dynamic.html#cb101-3"></a>  <span class="dt">by =</span> data<span class="op">$</span>continent,</span>
<span id="cb101-4"><a href="dynamic.html#cb101-4"></a>  <span class="dt">gdp =</span> <span class="kw">target</span>(</span>
<span id="cb101-5"><a href="dynamic.html#cb101-5"></a>    <span class="kw">median</span>(data<span class="op">$</span>gdpPercap),</span>
<span id="cb101-6"><a href="dynamic.html#cb101-6"></a>    <span class="dt">dynamic =</span> <span class="kw">group</span>(data, <span class="dt">.by =</span> by, <span class="dt">.trace =</span> by)</span>
<span id="cb101-7"><a href="dynamic.html#cb101-7"></a>  )</span>
<span id="cb101-8"><a href="dynamic.html#cb101-8"></a>)</span>
<span id="cb101-9"><a href="dynamic.html#cb101-9"></a></span>
<span id="cb101-10"><a href="dynamic.html#cb101-10"></a><span class="kw">make</span>(plan)</span>
<span id="cb101-11"><a href="dynamic.html#cb101-11"></a><span class="co">#&gt; [32m▶[39m dynamic gdp</span></span>
<span id="cb101-12"><a href="dynamic.html#cb101-12"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_7e88fb1c</span></span>
<span id="cb101-13"><a href="dynamic.html#cb101-13"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_a61b8e1b</span></span>
<span id="cb101-14"><a href="dynamic.html#cb101-14"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_278ff532</span></span>
<span id="cb101-15"><a href="dynamic.html#cb101-15"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_6f3facea</span></span>
<span id="cb101-16"><a href="dynamic.html#cb101-16"></a><span class="co">#&gt; [32m❯[39m subtarget gdp_73037e69</span></span>
<span id="cb101-17"><a href="dynamic.html#cb101-17"></a><span class="co">#&gt; [32m■[39m finalize gdp</span></span></code></pre></div>
<p>The <code>gdp</code> target no longer contains any explicit reference to continent.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="dynamic.html#cb102-1"></a><span class="kw">readd</span>(gdp)</span>
<span id="cb102-2"><a href="dynamic.html#cb102-2"></a><span class="co">#&gt; [1]  2646.787 12081.749  1192.138  5465.510 17983.304</span></span></code></pre></div>
<p>However, we can look up the continents in the trace.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="dynamic.html#cb103-1"></a><span class="kw">read_trace</span>(<span class="st">&quot;by&quot;</span>, gdp)</span>
<span id="cb103-2"><a href="dynamic.html#cb103-2"></a><span class="co">#&gt; [1] Asia     Europe   Africa   Americas Oceania </span></span>
<span id="cb103-3"><a href="dynamic.html#cb103-3"></a><span class="co">#&gt; Levels: Africa Americas Asia Europe Oceania</span></span></code></pre></div>
</div>
<div id="max_expand" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> <code>max_expand</code></h2>
<p>Suppose we want a model for each <em>country</em>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="dynamic.html#cb104-1"></a>gapminder_countries &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb104-2"><a href="dynamic.html#cb104-2"></a>  gapminder <span class="op">%&gt;%</span></span>
<span id="cb104-3"><a href="dynamic.html#cb104-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">gdpPercap =</span> <span class="kw">scale</span>(gdpPercap)) <span class="op">%&gt;%</span></span>
<span id="cb104-4"><a href="dynamic.html#cb104-4"></a><span class="st">    </span><span class="kw">split</span>(<span class="dt">f =</span> .<span class="op">$</span>country)</span>
<span id="cb104-5"><a href="dynamic.html#cb104-5"></a>}</span>
<span id="cb104-6"><a href="dynamic.html#cb104-6"></a></span>
<span id="cb104-7"><a href="dynamic.html#cb104-7"></a>plan &lt;-<span class="st"> </span><span class="kw">drake_plan</span>(</span>
<span id="cb104-8"><a href="dynamic.html#cb104-8"></a>  <span class="dt">countries =</span> <span class="kw">gapminder_countries</span>(),</span>
<span id="cb104-9"><a href="dynamic.html#cb104-9"></a>  <span class="dt">model =</span> <span class="kw">target</span>(<span class="kw">fit_model</span>(countries), <span class="dt">dynamic =</span> <span class="kw">map</span>(countries))</span>
<span id="cb104-10"><a href="dynamic.html#cb104-10"></a>)</span></code></pre></div>
<p>The Gapminder dataset has 142 countries, which can get overwhelming. In the early stages of the workflow when we are still debugging and testing, we can limit the number of sub-targets using the <code>max_expand</code> argument of <code>make()</code>.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="dynamic.html#cb105-1"></a><span class="kw">make</span>(plan, <span class="dt">max_expand =</span> <span class="dv">2</span>)</span>
<span id="cb105-2"><a href="dynamic.html#cb105-2"></a><span class="co">#&gt; [32m▶[39m target countries</span></span>
<span id="cb105-3"><a href="dynamic.html#cb105-3"></a><span class="co">#&gt; [32m▶[39m dynamic model</span></span>
<span id="cb105-4"><a href="dynamic.html#cb105-4"></a><span class="co">#&gt; [32m❯[39m subtarget model_ab009698</span></span>
<span id="cb105-5"><a href="dynamic.html#cb105-5"></a><span class="co">#&gt; [32m❯[39m subtarget model_cc031a6d</span></span>
<span id="cb105-6"><a href="dynamic.html#cb105-6"></a><span class="co">#&gt; [32m■[39m finalize model</span></span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="dynamic.html#cb106-1"></a><span class="kw">readd</span>(model)</span>
<span id="cb106-2"><a href="dynamic.html#cb106-2"></a><span class="co">#&gt; [90m# A tibble: 4 x 4[39m</span></span>
<span id="cb106-3"><a href="dynamic.html#cb106-3"></a><span class="co">#&gt;   continent term        statistic  p.value</span></span>
<span id="cb106-4"><a href="dynamic.html#cb106-4"></a><span class="co">#&gt;   [3m[90m&lt;fct&gt;[39m[23m     [3m[90m&lt;chr&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m</span></span>
<span id="cb106-5"><a href="dynamic.html#cb106-5"></a><span class="co">#&gt; [90m1[39m Asia      (Intercept)    -[31m1[39m[31m.[39m[31m48[39m  0.170   </span></span>
<span id="cb106-6"><a href="dynamic.html#cb106-6"></a><span class="co">#&gt; [90m2[39m Asia      year           -[31m0[39m[31m.[39m[31m233[39m 0.821   </span></span>
<span id="cb106-7"><a href="dynamic.html#cb106-7"></a><span class="co">#&gt; [90m3[39m Europe    (Intercept)    -[31m4[39m[31m.[39m[31m76[39m  0.000[4m7[24m[4m7[24m[4m3[24m</span></span>
<span id="cb106-8"><a href="dynamic.html#cb106-8"></a><span class="co">#&gt; [90m4[39m Europe    year            4.59  0.000[4m9[24m[4m9[24m[4m8[24m</span></span></code></pre></div>
<p>Then, when we are confident and ready, we can scale up to the full number of models.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="dynamic.html#cb107-1"></a><span class="kw">make</span>(plan)</span></code></pre></div>

</div>
</div>
<div style = "background: #1C356D; color: white; padding: 10px 10px 10px 25px; font-size: 1em; width: 100%;">
  Copyright Eli Lilly and Company
</div>
            </section>

          </div>
        </div>
      </div>
<a href="static.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="projects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ropensci-books/drake/edit/master/dynamic.Rmd",
"text": "Edit this chapter"
},
"history": {
"link": "https://github.com/ropensci-books/drake/commits/master/dynamic.Rmd",
"text": "Chapter edit history"
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
